<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>CheckInCount</title>
</head>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"
		integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
		crossorigin="anonymous"></script>
<style>
	body {
		background: black;
	}
	.main {
		display: flex;
		align-items: center;
		justify-content: center;
	}
	.container {
  		flex: 1;
		color: white;
		text-align: center;
		padding: 0px;
		margin: 0px;
	}
	#count {
		font-size: 350px;
		margin: 0px;
	}
	#header {
		font-size: 50px;
	}
</style>

<body>
	<div class="main"> 
		<div class="container">
			<p id="header">Total Check-ins Today</p>
			<p id="count">0</p>
		</div>
	</div>
</body>

<script>
/***********
	Animates element's number to new number with commas
	Parameters:
		stop (number): number to stop on
		commas (boolean): turn commas on/off (default is true)
		duration (number): how long in ms (default is 1000)
		ease (string): type of easing (default is "swing", others are avaiable from jQuery's easing plugin
	Examples:
		$("#div").animateNumbers(1234, false, 500, "linear"); // half second linear without commas
		$("#div").animateNumbers(1234, true, 2000); // two second swing with commas
		$("#div").animateNumbers(4321); // one second swing with commas

	This fully expects an element containing an integer
	If the number is within copy then separate it with a span and target the span
	Will work in appropriate inputs
	Inserts and accounts for commas during animation by default

	https://github.com/talmand/jquery-animate-numbers
***********/
	
	(function($) {
	    $.fn.animateNumbers = function(stop, commas, duration, ease) {
	        return this.each(function() {
	            var $this = $(this);
	            var isInput = $this.is('input');
	            var start = parseInt(isInput ? $this.val().replace(/,/g, "") : $this.text().replace(/,/g, ""));
	            var regex = /(\d)(?=(\d\d\d)+(?!\d))/g;
	            commas = commas === undefined ? true : commas;
	            
	            // number inputs can't have commas or it blanks out
	            if (isInput && $this[0].type === 'number') {
	                commas = false;
	            }
	            
	            $({value: start}).animate({value: stop}, {
	                duration: duration === undefined ? 1000 : duration,
	                easing: ease === undefined ? "swing" : ease,
	                step: function() {
	                    isInput ? $this.val(Math.floor(this.value)) : $this.text(Math.floor(this.value));
	                    if (commas) {
	                        isInput ? $this.val($this.val().replace(regex, "$1,")) : $this.text($this.text().replace(regex, "$1,"));
	                    }
	                },
	                complete: function() {
	                    if (parseInt($this.text()) !== stop || parseInt($this.val()) !== stop) {
	                        isInput ? $this.val(stop) : $this.text(stop);
	                        if (commas) {
	                            isInput ? $this.val($this.val().replace(regex, "$1,")) : $this.text($this.text().replace(regex, "$1,"));
	                        }
	                    }
	                }
	            });
	        });
	    };
	})(jQuery);
	
	$(document).ready(function (){

		var height = $(window).height();
		$('.main').css('min-height', height);

		function fetchLatestCount(){
			$.get( "http://operator.api.getmyparking.com/api/v1/ParkingEvents/checkInCount", function( data ) {
				$( "#count" ).animateNumbers(data.checkInCount, false, 15000, "linear");
			});
			setTimeout(fetchLatestCount, 15000);
		}
		fetchLatestCount();
	});
</script>
</html>
